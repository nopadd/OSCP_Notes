# 8\_Kernel\_Exploits

## Background

* By exploiting vulnerabilities in the Linux Kernel we can sometimes escalate our privileges. What we usually need to know to test if a kernel exploit works is the OS, architecture and kernel version. 
* Don't use kernel exploits if you can avoid it. If you use it might crash the machine or put it in an unstable state. So kernel exploits should be the last resort.
* Always use a simpler priv-esc if you can. They can also produce a lot of stuff in the sys.log. So if you find anything good, put it up on your list and keep searching for other ways before exploiting it.

## Identify Distribution Type

```text
cat /etc/issue 
cat/etc/*-release
```

* Good general hint no matter the OS flavor.

  ```text
  uname -a
  ```

* Generic command for all LSB distros

  ```text
  lsb_release -d
  ```

* Generic for distros using “systemd” 

  ```text
  /etc/os-release
  ```

* Generic but often modified 

  ```text
  /etc/issue 
  cat /etc/*release
  ```

* Novell SUSE 

  ```text
  /etc/SUSE-release
  ```

* Red Hat 

  ```text
  /etc/redhat-release
  /etc/redhat_version
  ```

* Fedora

  ```text
  /etc/fedora-release
  ```

* Slackware

  ```text
  /etc/slackware-release
  /etc/slackware-version
  ```

* Debian

  ```text
  /etc/debian_release
  /etc/debian_version 
  cat/etc/lsb-release
  ```

* Mandrake

  ```text
  /etc/mandrake-release
  ```

* Sun JDS

  ```text
  /etc/sun-release
  ```

* Solaris/Sparc

  ```text
  /etc/release
  ```

* Gentoo

  ```text
  /etc/gentoo-release
  ```

* Arch Linux \(file will be empty\) 

  ```text
  /etc/arch-release
  ```

* OpenBSD; sample: “OpenBSD.amd64” 

  ```text
  arch
  ```

## Kernal Version

```text
uname -a 
uname -mrs 
cat /proc/version 
rpm -q kernel 
dmesg | grep Linux 
ls /boot | grep vmlinuz-
```

## Dirty Cow Exploit

Linux Kernel &lt;= 3.19.0-73.8 \(Dirty Cow Github\)\[[https://github.com/dirtycow/dirtycow.github.io/wiki/PoCs](https://github.com/dirtycow/dirtycow.github.io/wiki/PoCs)\]

